<?xml version='1.0' ?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">

<script>
   itemSize = 0;
   storagePath = getStoragePath("tmp");
   storagePath = storagePath + "shoutcastGenre.dat";
   cachePath = getStoragePath("key");
   storagePath_genre = cachePath + "genreTitle.cache";
   storagePath_itemsize = cachePath + "genreItemSize.cache";
</script>

	<mediaDisplay name=photoView centerXPC=10 columnCount=5 rowCount=6
		menuBorderColor="55:55:55"
		sideColorBottom="0:0:0"
		sideColorTop="0:0:0"
		itemImageXPC="10"
		backgroundColor="0:0:0"
		imageBorderColor="15:20:230"
		imageBorderPC="1"
		itemBackgroundColor="0:0:0"
		centerHeightPC=60
		centerYPC=20
		itemGapXPC=3
		itemGapYPC=3
		sideTopHeightPC=15
		bottomYPC=85
		
		headerXPC=20
		headerYPC=2
		headerWidthPC=50
		headerHeightPC=10
		menuOffsetYPC=10
		
		sliding=yes
		showHeader=no
		>
	 	<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_01.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_02.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_03.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_04.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_05.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_06.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_07.png </idleImage>
		<idleImage idleImageWidthPC=10 idleImageHeightPC=10> image/POPUP_LOADING_08.png </idleImage>
		<text offsetXPC=25 offsetYPC=3 widthPC=50 heightPC=20 fontSize=24 backgroundColor=-1:-1:-1 foregroundColor=200:200:200>
			Shoutcast Radio - Genre List
		</text>
		<image offsetXPC=0 offsetYPC=19 widthPC=100 heightPC=1>
			image/gradient_line.bmp
		</image>
		<image offsetXPC=0 offsetYPC=80 widthPC=100 heightPC=1>
			image/gradient_line.bmp
		</image>

  <hidden>
    <previewWindow windowColor=0:0:0 offsetXPC=25 offsetYPC=75 widthPC=60 heightPC=20>
    </previewWindow>
  </hidden>
  
<onUserInput>
<script>
ret = "false";
majorContext = getPageInfo("majorContext");
minorContext = getPageInfo("minorContext");
userInput = currentUserInput();

if (userInput == "pagedown" || userInput == "pageup")
{
  idx = Integer(getFocusItemIndex());
  if (userInput == "pagedown")
  {
    idx -= -30;
    if(idx &gt;= itemSize)
      idx = itemSize-1;
  }
  else
  {
    idx -= 30;
    if(idx &lt; 0)
      idx = 0;
  }
  
  print("new idx: "+idx);
  setFocusItemIndex(idx);
	setItemFocus(0);
  redrawDisplay();
  "true";
}
else if (majorContext == "items" &amp;&amp; userInput == "enter") {
     idx = getFocusItemIndex();
     genre = getStringArrayAt(titleArray , idx);
     print("IDX is ", idx);
     print("I think Genre should be ", genre);

     writeStringToFile(storagePath, genre);
} 
ret;
</script>
</onUserInput>

		<itemDisplay>
			<text offsetXPC=0 offsetYPC=25 widthPC=100 heightPC=50 fontSize=15 backgroundColor=-1:-1:-1 foregroundColor=200:200:200>
				<script>
					getStringArrayAt(titleArray , -1);
				</script>
			</text>
		</itemDisplay>
	</mediaDisplay>


<script>
  titleArray = readStringFromFile(storagePath_genre);
  currentUrl = "http://www.shoutcast.com:80/sbin/newxml.phtml";
  dlok = null;
  if(titleArray == null)
    tries = 3;
  else
    tries = 1;
  while(tries &gt; 0 &amp;&amp; dlok == null)
  {
    tries -= 1;
    dlok = loadXMLFile(currentUrl);
  }
  
if(dlok == null)
{
  print("titleArray=",titleArray);
  if(titleArray == null)
  {
    postMessage("return");
  }
  else
  {
    itemSize = Integer(readStringFromFile(storagePath_itemsize));
   	setFocusItemIndex(0);
  }
}
else
{
	itemSize = getXMLElementCount("genrelist","genre");
	print("Item Size = ", itemSize);
	
	count=0;
	while(itemSize != 0)
	{
  		name = getXMLAttribute("genrelist","genre",count,"name");

	  	titleArray  = pushBackStringArray(titleArray, name);
 
  		count += 1;
	  	if (count == itemSize)
  		{
			  break;
	  	}
	}
	if(titleArray != "")
	{
	  writeStringToFile(storagePath_genre, titleArray);
	  writeStringToFile(storagePath_itemsize, itemSize);
	}
	setFocusItemIndex(0);
}
</script>

<item_template>
	  <link>rss_file://./rss/shoutcast/radio_shoutcastGenre.rss</link>
</item_template>


<channel>
	<title>Shoutcast Radio</title>
	<link>./rss/shoutcast/radio_shoutcast.rss</link>
	<media:thumbnail url="rss/image/shoutcast.png" width="120" height="90" />
	
	
<itemSize>
	<script>
		itemSize;
	</script>
</itemSize>

</channel>
</rss>
